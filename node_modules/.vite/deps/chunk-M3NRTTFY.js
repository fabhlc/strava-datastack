import {
  writable
} from "./chunk-2Q2OS3AX.js";

// ../../node_modules/@evidence-dev/component-utilities/src/stores.js
import { dev } from "$app/environment";
import { browser } from "$app/environment";
var pageHasQueries = writable(true);
var routeHash = writable("");
function createToastsObject() {
  const { subscribe, update } = writable([]);
  const timeoutMap = /* @__PURE__ */ new Map();
  const removeToast = (id) => {
    update(($toasts) => $toasts.filter((existing) => existing.id !== id));
  };
  return {
    subscribe,
    /**
     *
     * @param {Toast} toast
     * @param {number} [timeout]
     */
    add: (toast, timeout = 2e3) => {
      toast.id = toast.id ?? Math.random().toString();
      update(($toasts) => {
        const existing = $toasts.find((t) => t.id === toast.id);
        if (existing) {
          Object.assign(existing, toast);
          if (timeoutMap.has(toast.id)) {
            clearTimeout(timeoutMap.get(toast.id));
            timeoutMap.delete(toast.id);
          }
        } else {
          $toasts.push(toast);
        }
        return $toasts;
      });
      if (timeout) {
        const timeoutId = setTimeout(() => {
          removeToast(toast.id);
          timeoutMap.delete(toast.id);
        }, timeout);
        timeoutMap.set(toast.id, timeoutId);
      }
    },
    dismiss: (toastId) => {
      removeToast(toastId);
      if (timeoutMap.has(toastId)) {
        clearTimeout(timeoutMap.get(toastId));
        timeoutMap.delete[toastId];
      }
    }
  };
}
var toasts = createToastsObject();
var getStoreVal = (store) => {
  let v;
  store.subscribe((x) => v = x)();
  return v;
};
var localStorageStore = (key, init, serializeAndDeserialize) => {
  const serialize = (serializeAndDeserialize == null ? void 0 : serializeAndDeserialize.serialize) ?? JSON.stringify;
  const deserialize = (serializeAndDeserialize == null ? void 0 : serializeAndDeserialize.deserialize) ?? JSON.parse;
  const store = writable(browser ? deserialize(localStorage.getItem(key)) ?? init : init);
  const { subscribe, set } = store;
  const flush = (v) => {
    if (browser) {
      if (typeof v === "undefined" || v === null) {
        localStorage.removeItem(key);
      } else {
        localStorage.setItem(key, serialize(v));
      }
    }
  };
  flush(getStoreVal(store));
  return {
    subscribe,
    set: (v) => {
      set(v);
      flush(v);
    },
    update: (cb) => {
      const updatedStore = cb(getStoreVal(store));
      set(updatedStore);
      flush(updatedStore);
    }
  };
};
var showQueries = localStorageStore("showQueries", dev && browser);

export {
  pageHasQueries,
  routeHash,
  toasts,
  localStorageStore,
  showQueries
};
//# sourceMappingURL=chunk-M3NRTTFY.js.map
