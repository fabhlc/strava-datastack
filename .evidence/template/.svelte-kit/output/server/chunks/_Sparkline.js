import{c as P,g as H,a as V,e as z,V as Q,Q as B,h as W,i as Z}from"./DownloadData.js";import{c as F,h as g,j as J,v as A,o as K}from"./ssr.js";import{s as R,b as X}from"./utils.js";import{init as I,connect as Y}from"echarts";import{b as $}from"./index4.js";import ee from"chroma-js";import{l as te}from"./VennDiagram.svelte_svelte_type_style_lang.js";const ae=F((l,e,t,w)=>{let{data:a=void 0}=e,{row:o=0}=e,{column:s=void 0}=e,{value:c=void 0}=e,{text:i=void 0}=e,{chip:n=!1}=e,{downIsGood:r=!1}=e,{fmt:y=void 0}=e,{format_object:v=void 0}=e,{columnUnitSummary:u=void 0}=e,{showValue:d=!0}=e,{showSymbol:f=!0}=e,{symbolPosition:k="right"}=e,{align:x="right"}=e,{fontClass:b=n?"text-sm":"text-base"}=e,{neutralMin:_=0}=e,{neutralMax:T=0}=e;const p={positive:r?"text-negative":"text-positive",negative:r?"text-positive":"text-negative",neutral:"text-base-content-muted"},N={positive:r?"bg-negative/10 border border-negative/20":"bg-positive/10 border border-positive/20",negative:r?"bg-positive/10 border border-positive/20":"bg-negative/10 border border-negative/20",neutral:"bg-base-200 border border-base-300"};let C,S,h,E,m;e.data===void 0&&t.data&&a!==void 0&&t.data(a),e.row===void 0&&t.row&&o!==void 0&&t.row(o),e.column===void 0&&t.column&&s!==void 0&&t.column(s),e.value===void 0&&t.value&&c!==void 0&&t.value(c),e.text===void 0&&t.text&&i!==void 0&&t.text(i),e.chip===void 0&&t.chip&&n!==void 0&&t.chip(n),e.downIsGood===void 0&&t.downIsGood&&r!==void 0&&t.downIsGood(r),e.fmt===void 0&&t.fmt&&y!==void 0&&t.fmt(y),e.format_object===void 0&&t.format_object&&v!==void 0&&t.format_object(v),e.columnUnitSummary===void 0&&t.columnUnitSummary&&u!==void 0&&t.columnUnitSummary(u),e.showValue===void 0&&t.showValue&&d!==void 0&&t.showValue(d),e.showSymbol===void 0&&t.showSymbol&&f!==void 0&&t.showSymbol(f),e.symbolPosition===void 0&&t.symbolPosition&&k!==void 0&&t.symbolPosition(k),e.align===void 0&&t.align&&x!==void 0&&t.align(x),e.fontClass===void 0&&t.fontClass&&b!==void 0&&t.fontClass(b),e.neutralMin===void 0&&t.neutralMin&&_!==void 0&&t.neutralMin(_),e.neutralMax===void 0&&t.neutralMax&&T!==void 0&&t.neutralMax(T),n=n==="true"||n===!0,r=r==="true"||r===!0,d=d==="true"||d===!0,f=f==="true"||f===!0;try{if(C=void 0,a){if(typeof a=="string")throw Error(`Received: data=${a}, expected: data={${a}}`);if(Array.isArray(a)||(a=[a]),isNaN(o))throw Error("row must be a number (row="+o+")");try{Object.keys(a[o])[0]}catch{throw Error("Row "+o+" does not exist in the dataset")}s=s??Object.keys(a[o])[0],P(a,[s]),h=H(a,"array"),S=a[o][s],h=h.filter(M=>M.id===s),y?E=V(y,h[0].format?.valueType):E=h[0].format}else if(c!==void 0){if(isNaN(c))throw Error("value must be a number (value="+c+")");S=c,E=y?V(y,"number"):v??void 0}else throw Error("No data or value provided. If you referenced a query result, check that the name is correct.");m=S>T?"positive":S<_?"negative":"neutral"}catch(M){C=M.message,console.error("\x1B[31m%s\x1B[0m",`Error in Value: ${C}`)}return`${C?`${A(Q,"ValueError").$$render(l,{error:C},{},{})}`:`<span class="${["m-0 "+g(b,!0)+" font-ui inline-block rounded-md "+g(p[m],!0)+" "+g(n?N[m]:"",!0),n?"px-1":""].join(" ").trim()}"><span${J({"text-align":x??"right"})}>${k==="right"?`${d?`${S===null?'<span class="font-[system-ui]" data-svelte-h="svelte-45ueay">–</span>':`<span>${g(z(S,E,u))}</span>`}`:""} ${f?`<span class="font-[system-ui]"><!-- HTML_TAG_START -->${m==="positive"?"&#9650;":m==="negative"?"&#9660;":"–&thinsp;"}<!-- HTML_TAG_END --></span>`:""}`:`${f?`<span class="font-[system-ui]"><!-- HTML_TAG_START -->${m==="positive"?"&#9650;":m==="negative"?"&#9660;":"—"}<!-- HTML_TAG_END --></span>`:""} ${d?`${S===null?'<span class="font-[system-ui]" data-svelte-h="svelte-45ueay">–</span>':`<span>${g(z(S,E,u))}</span>`}`:""}`} ${i?`<span>${g(i)}</span>`:""}</span></span>`}`}),{Object:oe}=Z;let re="Delta";const he=F((l,e,t,w)=>{let a,{data:o=void 0}=e;const s=typeof o=="object"&&"__isQueryStore"in o?o.hash:void 0;let c=o?.hash===s,{emptySet:i=void 0}=e,{emptyMessage:n=void 0}=e;return e.data===void 0&&t.data&&o!==void 0&&t.data(o),e.emptySet===void 0&&t.emptySet&&i!==void 0&&t.emptySet(i),e.emptyMessage===void 0&&t.emptyMessage&&n!==void 0&&t.emptyMessage(n),c=o?.hash===s,a=Object.fromEntries(Object.entries(e).filter(([,r])=>r!==void 0)),` ${A(B,"QueryLoad").$$render(l,{data:o},{},{skeleton:()=>'<p slot="skeleton" class="text-base-content-muted" data-svelte-h="svelte-1vn8ohu">Loading...</p>',empty:()=>`<span slot="empty">${a.placeholder?"":`${A(W,"EmptyChart").$$render(l,{emptyMessage:n,emptySet:i,chartType:re,isInitial:c},{},{})}`}</span>`,default:({loaded:r})=>`${A(ae,"Delta").$$render(l,oe.assign({},a,{data:r?.__isQueryStore?Array.from(r):r}),{},{})}`})}`});function le(l,e){if(l){if(l=Number(l),isNaN(l))throw Error("height must be a number");if(l<=0)throw Error("height must be a positive number")}else l=15;if(e){if(e=Number(e),isNaN(e))throw Error("width must be a number");if(e<=0)throw Error("width must be a positive number")}else e=50;return{height:l,width:e}}function ie(l,e,t,w,a){const o=H(l);if(o[t].type!=="date")throw Error("dateCol must be of type date");const s=o[e].format,c=o[t].format,i=w?V(w):s,n=a?V(a):c;return{value_format_object:i,date_format_object:n}}function ne(l,e,t,w,a,o,s,c,i){return{title:{subtextStyle:{width:"100%"}},tooltip:{trigger:"axis",position:function(n,r,y,v,u){return[u.viewSize[0]/2-u.contentSize[0]/2,-11]},formatter:function(n){const r=n[0],y=`<div style="text-align: center; background-color: ${i.colors["base-200"]}; border-radius: 1px; padding: 0px 2px;">${z(r.value[1],o)}</div>`,v=`<div style="background-color: transparent; height: ${c-1.5}px;"></div>`,u=`<div style="text-align: center; height: 1em; background-color: transparent; border-radius: 1px; padding: 0px 2px;">${z(r.axisValueLabel,s)}</div>`;return y+v+u},backgroundColor:"transparent",borderWidth:0,borderColor:"transparent",extraCssText:"box-shadow: none; padding-bottom: 0;",padding:0,textStyle:{fontSize:9}},legend:{show:!1},grid:{left:0,right:0,bottom:0,top:0,containLabel:!0},xAxis:{type:"time",splitLine:{show:!1},axisTick:{show:!1},axisLabel:{show:!1,hideOverlap:!0,showMaxLabel:!1,formatter:!1,margin:6},scale:!0,z:2,boundaryGap:"2%",axisPointer:{show:!0,snap:!0,type:"line",z:0,lineStyle:{width:.5},handle:{show:!1},label:{show:!1}}},yAxis:[{type:"value",logBase:10,splitLine:{show:!1},axisLine:{show:!1,onZero:!1},axisTick:{show:!1},axisLabel:{show:!1,hideOverlap:!0,margin:4},name:"",nameLocation:"end",nameTextStyle:{align:"left",verticalAlign:"top",padding:[0,5,0,0]},nameGap:6,scale:a,boundaryGap:["1%","1%"],z:2}],series:[{type:t,triggerLineEvent:!0,label:{show:!1,position:"top",padding:0,fontSize:9},labelLayout:{hideOverlap:!0},connectNulls:!1,emphasis:{disabled:!0},lineStyle:{width:1,type:"solid",color:w??i.colors["base-content-muted"]},areaStyle:{color:e==="area"?w?ee(w).brighten(1.5).hex():i.colors["base-300"]:"transparent"},itemStyle:{color:w??i.colors["base-content-muted"]},showSymbol:!1,symbol:"circle",symbolSize:0,step:!1,name:"sparkline",data:l,yAxisIndex:0}],animation:!1}}const ye=F((l,e,t,w)=>{let a,o,s,c,i=X,n=()=>(i(),i=R(a,L=>c=L),a);const{theme:r,resolveColor:y}=te();s=R(r,L=>o=L);let{config:v={}}=e,{width:u=50}=e,{height:d=15}=e,{interactive:f=!0}=e,k,x=null,{data:b=void 0}=e,{dateCol:_=void 0}=e,{valueCol:T=void 0}=e,{valueFmt:p=void 0}=e,N,{dateFmt:C=void 0}=e,S,{type:h="line"}=e,{color:E=void 0}=e,{yScale:m=!1}=e,M=h==="area"?"line":h,{connectGroup:j=void 0}=e,D,O;function U(){f&&k&&!x&&(x=I(k,"evidence-light",{renderer:"svg",width:u,height:d}),x.setOption(v),j&&(x.group=j,Y(j)))}K(()=>{x&&x.dispose()}),e.config===void 0&&t.config&&v!==void 0&&t.config(v),e.width===void 0&&t.width&&u!==void 0&&t.width(u),e.height===void 0&&t.height&&d!==void 0&&t.height(d),e.interactive===void 0&&t.interactive&&f!==void 0&&t.interactive(f),e.data===void 0&&t.data&&b!==void 0&&t.data(b),e.dateCol===void 0&&t.dateCol&&_!==void 0&&t.dateCol(_),e.valueCol===void 0&&t.valueCol&&T!==void 0&&t.valueCol(T),e.valueFmt===void 0&&t.valueFmt&&p!==void 0&&t.valueFmt(p),e.dateFmt===void 0&&t.dateFmt&&C!==void 0&&t.dateFmt(C),e.type===void 0&&t.type&&h!==void 0&&t.type(h),e.color===void 0&&t.color&&E!==void 0&&t.color(E),e.yScale===void 0&&t.yScale&&m!==void 0&&t.yScale(m),e.connectGroup===void 0&&t.connectGroup&&j!==void 0&&t.connectGroup(j),f=f==="true"||f===!0,n(a=y(E)),m=m==="true"||m===!0;try{if(!["line","area","bar"].includes(h))throw Error("type must be line, area, or bar");({height:d,width:u}=le(d,u)),P(b,[T,_]),{value_format_object:N,date_format_object:S}=ie(b,T,_,p,C);const L=b.map(G=>[G[_],G[T]]);if(L.sort((G,q)=>G[0]-q[0]),v=ne(L,h,M,c,m,N,S,d,o),!$){const G=I(null,"evidence-light",{ssr:!0,renderer:"svg",height:d,width:u});G.setOption(v),D=G.renderToSVGString(),G.dispose()}}catch(L){O=L,console.error("\x1B[31m%s\x1B[0m",`Error in Sparkline: ${O.message}`)}return U(),s(),i(),`${O?`${A(Q,"ValueError").$$render(l,{error:O},{},{})}`:`${`<div class="inline-block align-baseline" style="${"width: "+g(u,!0)+"px; height: "+g(d,!0)+"px;"}"><!-- HTML_TAG_START -->${D}<!-- HTML_TAG_END --></div>`}`}`});export{he as D,ye as S};
